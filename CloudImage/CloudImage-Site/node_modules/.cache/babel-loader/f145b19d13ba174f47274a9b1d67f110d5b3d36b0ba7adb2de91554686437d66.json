{"ast":null,"code":"import{useState,useContext,createContext}from'react';import{useNavigate}from\"react-router-dom\";import{NavBar}from'./home';import\"./login.css\";import{useAuth}from'./authContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Login(){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"login_main\",children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsx(Form,{})]})});}function Form(){const[Username,setUsername]=useState(null);const[Password,setPassword]=useState(null);const[Failed,setFailed]=useState(false);const navigate=useNavigate();const{login}=useAuth();function loginHandler(){fetch(process.env.REACT_APP_API_BASE_URL+\"/auth/login\",{method:\"POST\",headers:{'content-type':'application/json'},body:JSON.stringify({username:Username,password:Password})}).then(response=>response.json()).then(json=>{console.log(json);return json['token'];}).then(token=>{localStorage.setItem(\"session_token\",token);localStorage.setItem(\"username\",Username);if(token==null){setFailed(true);}else{setFailed(false);login();navigate(\"/gallery\");}});}const flags=Failed?\"Failed Auth!\":\"Login Below\";return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"credentials-form\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"icon.png\"}),/*#__PURE__*/_jsx(\"p\",{className:\"messages\",children:flags}),/*#__PURE__*/_jsxs(\"div\",{className:\"submit-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"user\",placeholder:\"Username\",onChange:e=>setUsername(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"pass\",placeholder:\"Password\",onChange:e=>setPassword(e.target.value)}),/*#__PURE__*/_jsx(\"div\",{className:\"buttons\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:loginHandler,children:\"Login\"})})]})]})});}","map":{"version":3,"names":["useState","useContext","createContext","useNavigate","NavBar","useAuth","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Login","children","className","Form","Username","setUsername","Password","setPassword","Failed","setFailed","navigate","login","loginHandler","fetch","process","env","REACT_APP_API_BASE_URL","method","headers","body","JSON","stringify","username","password","then","response","json","console","log","token","localStorage","setItem","flags","src","type","id","placeholder","onChange","e","target","value","onClick"],"sources":["C:/Users/Arian/Documents/project/CIM-Project/client/website/src/login.js"],"sourcesContent":["import { useState, useContext, createContext} from 'react';\r\nimport {useNavigate} from \"react-router-dom\"; \r\nimport {NavBar} from './home'; \r\nimport \"./login.css\"; \r\nimport { useAuth } from './authContext'; \r\n\r\nexport default function Login(){ \r\n    return ( \r\n        <>\r\n            <div className='login_main'> \r\n                <NavBar></NavBar> \r\n                <Form></Form> \r\n            </div> \r\n        </>\r\n        \r\n    ); \r\n} \r\nfunction Form() { \r\n    const [Username,setUsername] = useState(null); \r\n    const [Password,setPassword] = useState(null); \r\n    const [Failed,setFailed] = useState(false); \r\n    const navigate = useNavigate(); \r\n    const { login } = useAuth(); \r\n\r\n    function loginHandler(){ \r\n        fetch(process.env.REACT_APP_API_BASE_URL+\"/auth/login\", {method:\"POST\", \r\n                                                    headers: {'content-type':'application/json'}, \r\n                                                    body: JSON.stringify({username: Username,password:Password }) \r\n            }) \r\n            .then((response) => response.json()) \r\n            .then((json) => {console.log(json); return json['token']})\r\n            .then((token) => {localStorage.setItem(\"session_token\",token); \r\n                              localStorage.setItem(\"username\",Username); \r\n                                if(token==null){ \r\n                                    setFailed(true); \r\n                                } else {\r\n                                    setFailed(false); \r\n                                    login(); \r\n                                    navigate(\"/gallery\"); \r\n                                }\r\n            }); \r\n    } \r\n    const flags = Failed ? \"Failed Auth!\" : \"Login Below\";   \r\n    return ( \r\n        <> \r\n            <div className=\"credentials-form\"> \r\n                <img src='icon.png'/>\r\n                <p className='messages'>{flags}</p> \r\n                <div className=\"submit-container\"> \r\n                    <input type=\"email\" id=\"user\" placeholder=\"Username\" onChange={(e) => setUsername(e.target.value)}/> \r\n                    <input type=\"password\" id=\"pass\" placeholder=\"Password\" onChange={(e) => setPassword(e.target.value)}/> \r\n                    <div className='buttons'> \r\n                        <button type=\"submit\" onClick={loginHandler}>Login</button> \r\n                    </div> \r\n                </div> \r\n            </div> \r\n        </> \r\n    ); \r\n} \r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}